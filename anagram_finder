import urllib.request
from collections import Counter


def find_clean_anagrams(user_input, max_words=3):
    # --- 1. LOAD A CURATED DICTIONARY ---
    # Using a list of common English words to avoid obscure junk like "Wy" or "Anjan"
    print("Loading common English words...")
    url = "https://raw.githubusercontent.com/first20hours/google-10000-english/master/google-10000-english-no-swears.txt"
    try:
        with urllib.request.urlopen(url) as response:
            all_words = response.read().decode('utf-8').splitlines()
    except Exception as e:
        return f"Error: {e}"

    # --- 2. PREPARE INPUT ---
    clean_input = "".join(filter(str.isalpha, user_input.lower()))
    input_letters = Counter(clean_input)

    # --- 3. FILTER FOR 'PURE' ENGLISH WORDS ---
    # We only want words that are actually in our letter pool
    candidates = []
    for word in all_words:
        if len(word) < 2 and word not in ['a', 'i']: continue

        word_letters = Counter(word)
        if all(word_letters[c] <= input_letters[c] for c in word_letters):
            candidates.append(word)

    # Sort by length to prioritize interesting combinations
    candidates.sort(key=len, reverse=True)

    print(f"Searching for phrases in '{user_input}'...")
    results = set()

    # --- 4. THE ASSEMBLY ENGINE ---
    def solve(current_phrase, remaining_letters):
        # If no letters left, we found a perfect English anagram
        if not any(remaining_letters.values()):
            phrase = " ".join(current_phrase).title()
            if phrase not in results:
                print(f"VALID ANAGRAM: {phrase}")
                results.add(phrase)
            return

        if len(current_phrase) >= max_words:
            return

        for word in candidates:
            word_letters = Counter(word)
            # Check if word fits in remaining letters
            if all(word_letters[c] <= remaining_letters[c] for c in word_letters):
                # Subtract letters and recurse
                new_pool = remaining_letters - word_letters
                solve(current_phrase + [word], new_pool)

    solve([], input_letters)


# Run it
find_clean_anagrams("Antony Wanjala")
